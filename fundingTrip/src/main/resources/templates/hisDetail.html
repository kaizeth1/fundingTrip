<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FundTrip</title>
  <script src="js/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style1.css">
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
    }
  </style>
  <script th:inline="javascript">
    $(function () {
      let m = [[${msg}]];
      if(m != null){
        alert(m);
      }
    });
  </script>
</head>
<body class="bg-white text-gray-800">
<header>
  <th:block th:insert="~{fragments::header(${session.member})}"/>
</header>
<section>
  <div class="content">
    <div class="write-form">
      <h2 class="login-header">상세 보기</h2>
        <!-- TITLE -->
        <div>
            <div class="t_content">유적지 이름:</div>
            <div class="d_content" th:if="${hisboard != null}" th:text="${hisboard.hisname}"></div>
            <div class="d_content" th:if="${hisboard == null}">게시물이 존재하지 않습니다.</div>
        </div>

        <!-- LOCAL -->
        <div>
            <div class="t_content">위치:</div>
            <div class="d_content" th:if="${hisboard != null}" th:text="${hisboard.hisloca}"></div>
            <div class="d_content" th:if="${hisboard == null}">게시물이 존재하지 않습니다.</div>
        </div>

        <!-- EXPLAN -->
        <div>
            <div class="t_content">설명:</div>
            <div class="d_content" th:if="${hisboard != null}" th:text="${hisboard.hisexplan}"></div>
            <div class="d_content" th:if="${hisboard == null}">게시물이 존재하지 않습니다.</div>
        </div>

        <!-- CONTENTS -->
        <div>
            <div class="t_content">시설 안내:</div>
            <div class="d_content" th:if="${hisboard != null}" th:text="${hisboard.hisinfo}"></div>
            <div class="d_content" th:if="${hisboard == null}">게시물이 존재하지 않습니다.</div>
        </div>

        <!-- FILES -->
        <div class="t_content file_h">유적지 사진</div>
        <div class="d_content file_h" style="overflow: auto">
            <th:block th:if="${#lists.isEmpty(hfList)}">
                첨부된 파일이 없습니다.
            </th:block>
            <th:block th:unless="${#lists.isEmpty(hfList)}">
                <th:block th:each="fitem:${hfList}">
                    <a th:href="@{download(hf_sysname=${fitem.hf_sysname},
                                                   hf_oriname=${fitem.hf_oriname})}">
                                <span class="file-title"
                                      th:text="${fitem.hf_oriname}"></span>
                    </a>
                </th:block>
            </th:block>
        </div>
        <th:block th:unless="${#lists.isEmpty(hfList)}">
            <div class="t_content  preview_h">PREVIEW</div>
            <div class="d_content  preview_h" style="overflow: auto">
                <th:block th:each="fitem:${hfList}">
                    <th:block th:if="${fitem.hf_oriname != null}">
                        <th:block th:if="${#strings.contains(fitem.hf_oriname, '.jpg')}">
                            <img th:src="@{upload/}+${fitem.hf_sysname}" width="100">
                        </th:block>
                        <th:block th:if="${#strings.contains(fitem.hf_oriname, '.png')}">
                            <img th:src="@{upload/}+${fitem.hf_sysname}" width="100">
                        </th:block>
                        <th:block th:if="${#strings.contains(fitem.hf_oriname, '.gif')}">
                            <img th:src="@{upload/}+${fitem.hf_sysname}" width="100">
                        </th:block>
                    </th:block>
                </th:block>
            </div>
        </th:block>
    </div>
        <div class="btn-area">
            <button class="btn-write" id="upbtn">수정</button>
            <button class="btn-write" id="delbtn">삭제</button>
            <button class="btn-sub" id="backbtn">뒤로가기</button>
        </div>
    </div>
</section>
<footer>
  <th:block th:insert="~{fragments::footer}" />
</footer>
</body>
<script th:inline="javascript">

  $("#backbtn").click(function () {
    let url = "/hisList?";

    const ListDto = [[${session.ldto}]];
    let colname = "";
    let keyword = "";
    if(ListDto != null){
      colname = ListDto.colname;
      keyword = ListDto.keyword;
    }

    let page = [[${session.pageNum}]];

    if(colname == null || colname === ""){//검색 안한 목록 이동
      url += `pageNum=${page}`;
    } else {//검색한 결과 목록으로 이동.
      url += `colname=${colname}&keyword=${keyword}&pageNum=${page}`;
    }
    //console.log(url);
    location.href = url;
  });

  $("#delbtn").click(function () {
    let con = confirm("게시글을 삭제합니다.");
    if(con === true){
        let hisnum = [[${hisboard?.hisnum}]];
        if (hisnum != null) {
            location.href = `/hisDelete?hisnum=${hisnum}`;
        }
    }
  });


  $("#upbtn").click(function () {
      let hisnum = [[${hisboard?.hisnum}]];
      if (hisnum != null) {
          location.href = `/hisUpdate?hisnum=${hisnum}`;
      }
  });
</script>
</html>